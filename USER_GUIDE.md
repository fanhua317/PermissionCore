# PermaCore 权限管理系统 - 用户操作手册

## 目录

1. [系统概述](#系统概述)
2. [登录系统](#登录系统)
3. [仪表盘](#仪表盘)
4. [用户管理](#用户管理)
5. [角色管理](#角色管理)
6. [权限管理](#权限管理)
7. [部门管理](#部门管理)
8. [日志查询](#日志查询)
9. [常见问题](#常见问题)

---

## 系统概述

PermaCore 是一个基于 **RBAC3（基于角色的访问控制）** 模型构建的企业级权限管理系统。系统支持：

- ✅ 用户、角色、权限的全生命周期管理
- ✅ 角色继承（子角色自动继承父角色权限）
- ✅ 职责分离约束（SoD）防止权限冲突
- ✅ 完整的操作审计日志
- ✅ JWT 安全认证机制

### 系统架构

| 层级 | 技术栈 |
|------|--------|
| 前端 | Vue 3 + TypeScript + Element Plus |
| 后端 | Spring Boot 3.x + Spring Security 6 |
| 数据库 | MySQL 8.x + MyBatis-Plus |
| 缓存 | Redis + Caffeine 二级缓存 |

---

## 登录系统

### 访问地址

- **前端地址**: `http://localhost:5173`
- **后端API**: `http://localhost:54321`

### 登录步骤

1. 打开浏览器，访问前端地址
2. 在登录页面输入用户名和密码
3. 点击「登录」按钮

### 默认管理员账户

| 用户名 | 密码 | 说明 |
|--------|------|------|
| admin | 123456 | 超级管理员（需提前在数据库初始化） |

### 登录失败处理

| 错误信息 | 原因 | 解决方案 |
|----------|------|----------|
| 用户不存在 | 用户名错误 | 检查用户名是否正确 |
| 密码错误 | 密码不正确 | 重新输入正确密码 |
| 用户已被禁用 | 账户状态异常 | 联系管理员启用账户 |

---

## 仪表盘

登录成功后，系统自动跳转到仪表盘页面。

### 统计信息

仪表盘顶部展示四个核心指标：

| 指标 | 说明 |
|------|------|
| 用户总数 | 系统中有效用户数量 |
| 角色数量 | 已创建的角色总数 |
| 权限点数 | 系统中所有权限项数量 |
| 今日登录 | 当天的登录次数 |

### 快捷操作

点击快捷操作卡片可快速跳转到相应功能模块：
- 👤 添加用户 → 用户管理页面
- 🎭 创建角色 → 角色管理页面
- 🏢 新建部门 → 部门管理页面
- 📊 查看日志 → 操作日志页面

### 最近操作

展示最近 5 条系统操作记录，便于快速了解系统活动。

---

## 用户管理

**路径**: 侧边栏 → 系统管理 → 用户管理

### 查看用户列表

页面默认展示所有用户，支持以下操作：
- **搜索**: 在搜索框输入用户名进行筛选
- **分页**: 底部分页器切换页码

### 添加用户

1. 点击页面右上角「添加用户」按钮
2. 在弹窗中填写用户信息：

| 字段 | 必填 | 说明 |
|------|------|------|
| 用户名 | ✅ | 登录账号，全局唯一 |
| 密码 | ✅ | 6-20位字符 |
| 昵称 | ❌ | 显示名称 |
| 邮箱 | ❌ | 用户邮箱 |
| 手机 | ❌ | 联系电话 |
| 部门 | ❌ | 所属部门 |
| 状态 | ✅ | 启用/禁用 |

3. 点击「确定」保存

### 编辑用户

1. 找到目标用户，点击操作列的「编辑」按钮
2. 修改需要更新的信息
3. 点击「确定」保存

### 分配角色

1. 点击用户操作列的「分配角色」按钮
2. 在弹窗中勾选需要分配的角色
3. 点击「确定」完成分配

> ⚠️ **注意**: 用户权限 = 直接分配的角色权限 + 继承的角色权限

### 删除用户

1. 点击操作列的「删除」按钮
2. 在确认对话框中点击「确定」

> ⚠️ 删除操作不可恢复，请谨慎操作

---

## 角色管理

**路径**: 侧边栏 → 系统管理 → 角色管理

### 角色列表

展示所有角色信息：
- 角色编码：唯一标识
- 角色名称：显示名称
- 描述：角色用途说明
- 状态：启用/禁用

### 创建角色

1. 点击「添加角色」按钮
2. 填写角色信息：

| 字段 | 必填 | 说明 |
|------|------|------|
| 角色编码 | ✅ | 如：admin, user, manager |
| 角色名称 | ✅ | 如：管理员、普通用户 |
| 描述 | ❌ | 角色职责描述 |
| 状态 | ✅ | 是否启用 |

3. 点击「确定」保存

### 分配权限

1. 点击角色的「分配权限」按钮
2. 在权限树中勾选需要的权限节点
3. 点击「确定」保存

**权限树结构说明**：
```
└── 系统管理 (菜单)
    ├── 用户管理 (菜单)
    │   ├── user:add (按钮)
    │   ├── user:edit (按钮)
    │   └── user:delete (按钮)
    └── 角色管理 (菜单)
        ├── role:add (按钮)
        └── role:assignPermission (按钮)
```

### 配置角色继承

角色继承允许子角色自动获得父角色的所有权限。

1. 点击「继承配置」按钮
2. 选择当前角色的父角色（可多选）
3. 点击「确定」保存

**继承示例**：
- `高级管理员` 继承 `管理员`
- `管理员` 继承 `普通用户`
- 则 `高级管理员` 自动拥有 `管理员` 和 `普通用户` 的所有权限

---

## 权限管理

**路径**: 侧边栏 → 系统管理 → 权限管理

### 权限类型

| 类型 | 图标 | 说明 |
|------|------|------|
| 菜单 | 📁 | 导航菜单项，用于页面访问控制 |
| 按钮 | 🔘 | 页面内操作按钮 |
| API | 🔗 | 后端接口权限 |

### 权限树

权限以树形结构展示，支持层级嵌套。

### 添加权限

1. 点击「添加权限」按钮
2. 填写权限信息：

| 字段 | 必填 | 说明 |
|------|------|------|
| 权限标识 | ✅ | 如：system:user:add |
| 权限名称 | ✅ | 如：添加用户 |
| 类型 | ✅ | 菜单/按钮/API |
| 父级权限 | ❌ | 选择所属上级 |
| 排序 | ❌ | 显示顺序 |
| 状态 | ✅ | 是否启用 |

3. 点击「确定」保存

### 权限标识命名规范

推荐使用三段式命名：`模块:功能:操作`

| 示例 | 说明 |
|------|------|
| system:user:add | 系统-用户-添加 |
| system:role:edit | 系统-角色-编辑 |
| system:permission:delete | 系统-权限-删除 |

---

## 部门管理

**路径**: 侧边栏 → 系统管理 → 部门管理

### 部门树

左侧展示组织架构树，点击部门节点可在右侧查看详情。

### 添加部门

1. 点击「添加部门」按钮
2. 填写部门信息：

| 字段 | 必填 | 说明 |
|------|------|------|
| 部门名称 | ✅ | 如：技术部 |
| 上级部门 | ❌ | 选择所属上级 |
| 负责人 | ❌ | 部门负责人 |
| 联系电话 | ❌ | 部门电话 |
| 排序 | ❌ | 显示顺序 |
| 状态 | ✅ | 正常/停用 |

3. 点击「确定」保存

### 部门详情

选中部门后，右侧面板展示：
- 📋 **基本信息**: 部门名称、负责人、电话等
- 👥 **部门成员**: 属于该部门的所有用户

---

## 日志查询

### 登录日志

**路径**: 侧边栏 → 日志管理 → 登录日志

记录所有用户的登录行为：
- 登录用户名
- 登录 IP 地址
- 浏览器类型
- 操作系统
- 登录时间
- 登录状态（成功/失败）
- 失败原因（如有）

**筛选功能**：
- 按日期范围筛选
- 按登录状态筛选（成功/失败）

### 操作日志

**路径**: 侧边栏 → 日志管理 → 操作日志

记录用户在系统中的所有操作：
- 操作模块
- 操作类型
- 请求方法
- 操作人
- 操作 IP
- 操作时间
- 执行结果

**查看详情**：
点击操作列的「详情」按钮，可查看完整的请求参数和响应结果。

---

## 常见问题

### Q1: 登录后看不到某些菜单？

**原因**: 当前用户没有对应菜单的访问权限

**解决方案**: 
1. 联系管理员为您的角色分配相应权限
2. 或将您添加到拥有该权限的角色中

### Q2: 分配了权限但还是无法操作？

**可能原因**：
1. 权限未生效，需重新登录
2. 权限状态被禁用
3. 存在职责分离约束（SoD）

**解决方案**：
1. 退出登录后重新登录
2. 检查权限状态是否启用
3. 检查 SoD 约束配置

### Q3: 如何批量删除数据？

**操作步骤**：
1. 勾选需要删除的数据行
2. 点击「批量删除」按钮
3. 确认删除操作

### Q4: 忘记密码怎么办？

**解决方案**：
1. 联系系统管理员重置密码
2. 管理员在用户管理中编辑用户并设置新密码

### Q5: 系统响应缓慢？

**可能原因**：
1. 网络连接问题
2. 后端服务负载过高
3. 数据库查询较慢

**解决方案**：
1. 检查网络连接
2. 联系运维人员检查服务器状态
3. 尝试清除浏览器缓存

---

## 技术支持

如遇到本手册未涵盖的问题，请联系技术支持：

- 📧 Email: support@permacore.com
- 📞 电话: 400-XXX-XXXX
- 💬 在线支持: 系统内置工单系统

---

**版本信息**

| 项目 | 说明 |
|------|------|
| 文档版本 | v1.0.0 |
| 更新日期 | 2025-12 |
| 适用系统版本 | PermaCore v1.0.x |

---

*© 2025 PermaCore Team. All Rights Reserved.*
